
<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <!--<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">-->

    <title>WINAIM</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Basic Styles -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/font-awesome.min.css">

    <!-- Production Styles : Please note (production.css) was created using LESS variables -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/production.css">
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/skins.css">

    <link rel="stylesheet" type="text/css" media="screen" href="~/css/override.css">

    <!-- FAVICONS -->
    <link rel="shortcut icon" href="~/img/favicon/favicon_winaim.ico" type="image/x-icon">
    <link rel="icon" href="~/img/favicon/favicon_winaim.ico" type="image/x-icon">

    <!-- GOOGLE FONT -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700">

</head>
<body id="login" class="animated fadeInDown">



    <div id="main" role="main">

        <!-- MAIN CONTENT -->
        <div id="content" class="container">

            <div class="row">
                
                <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4 col-md-offset-4">
                    <div class="well no-padding">
                        @using (Html.form("Index", "Login", FormMethod.Post, new Dictionary<string, object> { { "class", "smart-form client-form" }, { "id", "login-form" }, { "onsubmit", "LoginClick()" } }))
                        {
                       // @Html.AntiForgeryToken()
                        @*<form action="~/Home/DashBoard" id="login-form" class="smart-form client-form" method="post">*@
                        <header class="bg-color-blue text-center" style="color:#fff;">
                            Sign In
                        </header>

                        <fieldset>

                            <section>
                                <label class="label">Username</label>
                                <label class="input">
                                    <i class="icon-append fa fa-user"></i>
                                    @Html.TextBox(m => m.UserName, new Dictionary<string, object> { { "onkeypress", "return UserNameTextBoxValidationMethod(event);" }, { "autofocus", "autofocus" }, { "onblur", "AddAutoCompleteData(this)" }, { "onfocus", "loadAutoComplete(this)" } })
                                </label>
                            </section>

                            <section>
                                <label class="label">Password</label>
                                <label class="input">
                                    <i class="icon-append fa fa-lock"></i>
                                    <input type="password" id="Password" name="Password" onkeypress="return MyValidationMethod(event);"/>
                                </label>
                            </section>

                            <section>
                                <label class="label">Organization</label>
                                <label class="input">
                                    <i class="icon-append fa fa-lock"></i>
                                    @Html.TextBoxFor(m => m.OrganizationName, new Dictionary<string, object> { { "onkeypress", "return OrganizationNameTextBoxValidate(event);" }, {"onblur", "AddAutoCompleteData(this)"},{ "onfocus", "loadAutoComplete(this)"} })
                                </label>
                            </section>
                            <section>
                                
                                    @Html.CheckBoxFor(m => m.RememberMe, new Dictionary<string, object> { { "class", "filled-in" }, { "id", "RememberMe" }, { "type", "checkbox" }, { "style", "cursor:pointer;" } })
                                  
                                    <label for="RememberMe" style="cursor:pointer;">Remember me</label>
                                
                                </section>
                        </fieldset>
                        <footer>
                            <button type="submit" class="btn btn-primary">
                                Sign in
                            </button>
                            @if (ViewData.ModelState.IsValid)
                            {
                                @Html.ValidationSummary(false, "", new Dictionary<string, object> { { "class", "validation-summary-errors" }, { "style", "color:red;" } })
                            }
                            else
                            {
                                <script>
                                    $(document).ready(function () {
                                        if ($(".SmallBox").length > 0) {
                                            $(".SmallBox").remove();
                                        }
                                        $.smallBox({
                                            title: "@ViewData.ModelState["Error"].Errors[0].ErrorMessage",
                                            sound: false,
                                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                                            color: "#C46A69",
                                            //timeout: 8000,
                                            iconSmall: "fa fa-warning bounce animated",
                                            timeout: 10000
                                        });
                                    });
                                </script>
                            }
                        </footer>
                        @*</form>*@
                        }
                    </div>
                    <p class="font-xs margin-top-5 text-center">
                        Copyright ONEVIEW 2014-2020.

                    </p>

                    @*<h5 class="text-center"> - Or sign in using -</h5>

                        <ul class="list-inline text-center">
                            <li>
                                <a href="javascript:void(0);" class="btn btn-primary btn-circle"><i class="fa fa-facebook"></i></a>
                            </li>
                            <li>
                                <a href="javascript:void(0);" class="btn btn-info btn-circle"><i class="fa fa-twitter"></i></a>
                            </li>
                            <li>
                                <a href="javascript:void(0);" class="btn btn-warning btn-circle"><i class="fa fa-linkedin"></i></a>
                            </li>
                        </ul>*@

                </div>
            </div>

        </div>
    </div>

    <div id="targetDash"></div>

    <div id="spinner" class="spinner" style="display:none;">
        <img id="img-spinner" src="~/img/ajax-loader.gif" alt="Loading" />
    </div>

    <!--================================================== -->
    <!-- PACE LOADER - turn this on if you want ajax loading to show (caution: uses lots of memory on iDevices)-->
    @*<script src="~/js/plugin/pace/pace.min.js"></script>*@

    <!-- JS TOUCH : include this plugin for mobile drag / drop touch events
    <script src="js/plugin/jquery-touch/jquery.ui.touch-punch.min.js"></script> -->
    <!-- BOOTSTRAP JS -->
    <script src="~/js/bootstrap/bootstrap.min.js"></script>

    <!-- WIDGETS -->
    <script src="~/js/smartwidgets/widget.min.js"></script>

    <!-- JQUERY VALIDATE -->
    <script src="~/js/plugin/jquery-validate/jquery.validate.min.js"></script>

    <!-- JQUERY MASKED INPUT -->
    <script src="~/js/plugin/masked-input/jquery.maskedinput.min.js"></script>

    <!-- JQUERY SELECT2 INPUT -->
    <script src="~/js/plugin/select2/select2.min.js"></script>

    <!-- JQUERY UI + Bootstrap Slider -->
    <script src="~/js/plugin/bootstrap-slider/bootstrap-slider.min.js"></script>

    <!-- browser msie issue fix -->
    <script src="~/js/plugin/msie-fix/jquery.mb.browser.min.js"></script>

    <!-- FastClick: For mobile devices -->
    <script src="~/js/plugin/fastclick/fastclick.js"></script>

    <script src="~/js/winaimAjaxtool.js"></script>

    <!--[if IE 7]>

        <h1>Your browser is out of date, please update your browser by going to www.microsoft.com/download</h1>

    <![endif]-->
    <!-- MAIN APP JS FILE -->
    <script src="~/js/app.js"></script>

    <script src="~/js/loading-overlay.min.js"></script>

    <script type="text/javascript">
        runAllForms();

        ClearLocalStorage();

        $(window).bind('beforeunload', function (event) {
            //if(some condition that detects user hasn't clicked a link on your page)
            location.href = "/Login/Index";
        });

        function LoginClick() {
            if ($(".SmallBox").length > 0) {
                $(".SmallBox").remove();
            }
            var target = $('#targetDash');
            if (target.hasClass('loading')) {
                target.loadingOverlay('remove');
            } else {
                target.loadingOverlay();
            };
            var remeberme = $("#RememberMe").is(':checked');
            var username = $(document.getElementById('UserName')).val();
            var organizationname = $(document.getElementById('OrganizationName')).val();
            var loginDetails = window.localStorage.getItem("loginDetails");
            //loginDetails = loginDetails != null && loginDetails != "" ? atob(loginDetails) : "";
            loginDetails = loginDetails != null && loginDetails != "" ? JSON.parse(loginDetails) : {};

            if (remeberme == true || remeberme == "true") {
                window.localStorage["LastEnteredUserName"] = username;
                window.localStorage["LastEnteredOrganizationName"] = organizationname;
                loginDetails[username] = { WinAimOrganization: organizationname, WinAimRemember: true };
                //window.localStorage.setItem("loginDetails", btoa(JSON.stringify(loginDetails)));
                window.localStorage.setItem("loginDetails", JSON.stringify(loginDetails));
            }
            else {
                delete loginDetails[username];
                window.localStorage.removeItem("LastEnteredUserName");
                window.localStorage.removeItem("LastEnteredOrganizationName");
                //window.localStorage.setItem("loginDetails", btoa(JSON.stringify(loginDetails)));
                window.localStorage.setItem("loginDetails", JSON.stringify(loginDetails));
            }
        }

        $(document).ready(function () {
            var lastEnteredUserName = window.localStorage["LastEnteredUserName"];
            lastEnteredUserName = lastEnteredUserName == null ? "" : lastEnteredUserName;
            var lastEnteredOrganizationName = window.localStorage["LastEnteredOrganizationName"];
            lastEnteredOrganizationName = lastEnteredOrganizationName == null ? "" : lastEnteredOrganizationName;
            $(document.getElementById('UserName')).val(lastEnteredUserName);
            $(document.getElementById('OrganizationName')).val(lastEnteredOrganizationName);
            var loginDetails = window.localStorage.getItem("loginDetails");
            //loginDetails = loginDetails != null && loginDetails != "" ? atob(loginDetails) : "";
            loginDetails = loginDetails != null && loginDetails != "" ? JSON.parse(loginDetails) : {};
            if (loginDetails[lastEnteredUserName] != null && loginDetails[lastEnteredUserName]["WinAimRemember"] == true) {
                $('#RememberMe').prop('checked', true);
            }            

            $("#UserName").change(function () {
                var username = $(document.getElementById('UserName')).val();
                var loginDetails = window.localStorage.getItem("loginDetails");
                //loginDetails = loginDetails != null && loginDetails != "" ? atob(loginDetails) : "";
                loginDetails = loginDetails != null && loginDetails != "" ? JSON.parse(loginDetails) : {};
                if (loginDetails[username] != null && loginDetails[username]["WinAimRemember"] == true) {
                    $('#RememberMe').prop('checked', true);
                    $(document.getElementById('OrganizationName')).val(loginDetails[remeberusername]["WinAimOrganization"]);
                }
                else {
                    $('#RememberMe').prop('checked', false);
                    $(document.getElementById('OrganizationName')).val("");
                }
            });

            //$("#forgotpassword").click(forgotpasswordClick);
            $('.modal').modal();

            GetURLPath();
        });

        function UserNameTextBoxValidationMethod(e) {
            var keycode = e.keyCode ? e.keyCode : e.charCode

            if (keycode >= 48 && keycode <= 57)
                return true;
            else if ((keycode >= 64 && keycode <= 90) || (keycode >= 97 && keycode <= 122))
                return true;
            else if (keycode == 95 || keycode == 45 || keycode == 46 || keycode == 13 || keycode == 8 || keycode == 9)
                return true;
            else if ((keycode >= 36 && keycode <= 38) || (keycode >= 40 && keycode <= 43) || keycode == 61 || keycode == 33 || keycode == 58 || keycode == 32)
                return true;
            else
                return false;
            var target = $('#targetDash');
            target.loadingOverlay('remove');
        }

        function MyValidationMethod(e) {
            var keycode = e.keyCode ? e.keyCode : e.charCode

            if (keycode >= 48 && keycode <= 57)
                return true;
            else if ((keycode >= 64 && keycode <= 90) || (keycode >= 97 && keycode <= 122))
                return true;
            else if (keycode == 95 || keycode == 45 || keycode == 46 || keycode == 13 || keycode == 8 || keycode == 9)
                return true;
            else if ((keycode >= 36 && keycode <= 38) || (keycode >= 40 && keycode <= 43) || keycode == 61 || keycode == 33 || keycode == 58)
                return true;
            else
                return false;
            var target = $('#targetDash');
            target.loadingOverlay('remove');
        }

        function OrganizationNameTextBoxValidate(e) {
            var keycode = e.keyCode ? e.keyCode : e.charCode

            if (keycode >= 48 && keycode <= 57)
                return true;
            else if ((keycode >= 64 && keycode <= 90) || (keycode >= 97 && keycode <= 122))
                return true;
            else if (keycode == 95 || keycode == 45 || keycode == 46 || keycode == 13 || keycode == 8 || keycode == 9)
                return true;
            else if ((keycode >= 36 && keycode <= 38) || (keycode >= 40 && keycode <= 43) || keycode == 61 || keycode == 33 || keycode == 58 || keycode == 32)
                return true;
            else
                return false;
            var target = $('#targetDash');
            target.loadingOverlay('remove');
        }

        $(function () {

            // Validation
            $("#login-form").validate({
                // Rules for form validation
                rules: {
                    UserName: {
                        required: true,
                        minlength: 2,
                        maxlength: 20
                        //,
                        //email: true
                    },
                    Password: {
                        required: true,
                        minlength: 2,
                        maxlength: 20
                    },
                    OrganizationName: {
                        required: true
                    }
                },

                // Messages for form validation
                messages: {
                    UserName: {
                        required: 'Please enter Username'
                        //,
                        //email: 'Please enter a VALID email address'
                    },
                    Password: {
                        required: 'Please enter Password'
                    },
                    OrganizationName: {
                        required: 'Please enter Organization'
                    }
                },

                // Do not change code below
                errorPlacement: function (error, element) {
                    if (document.getElementById("UserName").value == "") {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: 'MN-RQ-AUT-001 :: Please enter Username',
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    else if (document.getElementById("UserName").value != "" && document.getElementById("UserName").value.length < 2) {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: "IN-NF-AUT-002 :: " + error.text(),
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    else if (document.getElementById("UserName").value != "" && document.getElementById("UserName").value.length > 20) {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: "IN-NF-AUT-001 :: " + error.text(),
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    else if (document.getElementById("Password").value == "") {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: 'MN-RQ-AUT-001 :: Please enter Password',
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    else if (document.getElementById("Password").value != "" && document.getElementById("Password").value.length < 2) {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: "IN-NF-AUT-002 :: " + error.text(),
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    else if (document.getElementById("Password").value != "" && document.getElementById("Password").value.length > 20) {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: "IN-NF-AUT-001 :: " + error.text(),
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    else if (document.getElementById("OrganizationName").value == "") {
                        if ($(".SmallBox").length > 0) {
                            $(".SmallBox").remove();
                        }
                        $.smallBox({
                            title: 'MN-RQ-AUT-001 :: Please enter Organization',
                            sound: false,
                            //content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                            color: "#C46A69",
                            //timeout: 8000,
                            iconSmall: "fa fa-warning bounce animated",
                            timeout: 4000
                        });
                        var target = $('#targetDash');
                        target.loadingOverlay('remove');
                    }
                    var target = $('#targetDash');
                    target.loadingOverlay('remove');
                    //if(element.length > 0)
                    //{
                    //    element[0].placeholder = error.text();
                    //}
                    //error.insertAfter(element.parent());
                }
            });
        });

        function GetURLPath() {
            var result = null;
            var _OneViewAjax = new WiNAiMAjax();
            _OneViewAjax.url = "@Url.Content("~/Home/GetURLPath")";
            _OneViewAjax.webMethod = "post";
            _OneViewAjax.async = false;
            _OneViewAjax.contentType = 'application/json; charset=utf-8';
            _OneViewAjax.dataType = 'json';
            result = _OneViewAjax.execute();
            if (result != undefined && result != null) {
                try {
                    window.localStorage.setItem("URLPath", result);
                    if (typeof (result) == 'object')
                        return result;
                    else
                        return null;
                }
                catch (ex) {
                    return null;
                }
            }
            else {
                return null;
            }
        }
    </script>

</body>

</html>